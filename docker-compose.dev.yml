services:
  postgres:
    ports:
      - "5433:5432"    # avoid conflict with local system postgres on 5432

  backend:
    ports:
      - "8080:8000"    # avoid conflict with local system service on port 80
    volumes:
      - ./backend:/var/www/html   # live source mount â€” Blade changes visible on refresh
      - vendor_cache:/var/www/html/vendor  # keep vendor built into the image

  vite:
    image: node:22-alpine
    container_name: openmmes-vite
    working_dir: /app
    volumes:
      - ./backend:/app             # shares source with backend
      - node_modules_cache:/app/node_modules
    ports:
      - "5173:5173"
    command: sh -c "npm install --silent && npm run dev"
    networks:
      - openmmes-network

volumes:
  vendor_cache:
  node_modules_cache:
